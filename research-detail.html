<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Research Project Details - ASU ResearchFund</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="./style.css" />
    <style>
      .video-container {
        position: relative;
        width: 100%;
        padding-bottom: 56.25%; /* 16:9 aspect ratio */
        background: #000;
        border-radius: 12px;
        overflow: hidden;
      }

      .video-container video {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: contain;
      }

      .info-card {
        background: white;
        border-radius: 12px;
        padding: 24px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }

      .author-card {
        transition: transform 0.2s ease;
      }

      .author-card:hover {
        transform: translateY(-2px);
      }

      .category-badge {
        display: inline-block;
        padding: 6px 16px;
        border-radius: 20px;
        font-size: 0.875rem;
        font-weight: 600;
        text-transform: uppercase;
      }
    </style>
  </head>
  <body class="bg-gray-50">
    <!-- Navbar -->
    <div id="navbar"></div>
    <script src="navbar.js"></script>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <!-- Back Button -->
      <a
        href="research-showcase.html"
        class="inline-flex items-center text-gray-600 hover:text-8c1d40 mb-6 transition-colors"
      >
        <svg
          class="w-5 h-5 mr-2"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M15 19l-7-7 7-7"
          ></path>
        </svg>
        Back to Research Showcase
      </a>

      <!-- Research Data Container (will be populated by JavaScript) -->
      <div id="researchDetail">
        <!-- Content will be dynamically loaded -->
      </div>
    </div>

    <script>
      // Global data storage
      let allData = null;
      let professors = [];
      let researchDatabase = {};

      // Load data from JSON file
      async function loadData() {
        try {
          const response = await fetch('./data.json');
          allData = await response.json();
          professors = allData.professors;
          
          // Process research projects and map authorIds to author objects
          allData.researchProjects.forEach(project => {
            const authors = project.authorIds.map((id, index) => {
                // console.log(id, index);
              const prof = professors.find(p => p.id === id);
            //   console.log(prof);
              return {
                name: prof ? prof.name : 'Unknown',
                affiliation: prof ? prof.affiliation : 'Arizona State University',
                email: prof ? prof.email : '',
                role: index === 0 ? 'Principal Investigator' : 'Co-Investigator'
              };
            });
            
            researchDatabase[project.id] = {
              ...project,
              authors: authors
            };
            // console.log(researchDatabase[project.id]);
            
            // Add default values for projects without full details
            if (!researchDatabase[project.id].abstract) {
              researchDatabase[project.id].abstract = project.description + " This research project represents a significant contribution to the field, utilizing cutting-edge methodologies and innovative approaches to address critical challenges. The work demonstrates rigorous scientific investigation and has the potential to make substantial impact in its respective domain.";
            }
            if (!researchDatabase[project.id].methodology) {
              researchDatabase[project.id].methodology = "The research employs state-of-the-art techniques and methodologies relevant to the field. Data collection and analysis follow established scientific protocols, ensuring reproducibility and validity of results.";
            }
            if (!researchDatabase[project.id].results) {
              researchDatabase[project.id].results = "Preliminary results demonstrate promising outcomes that align with the research objectives. Further analysis and validation are ongoing to fully characterize the findings.";
            }
            if (!researchDatabase[project.id].impact) {
              researchDatabase[project.id].impact = "This research has the potential to contribute significantly to the field, with implications for both theoretical understanding and practical applications. The findings may inform future research directions and policy decisions.";
            }
            if (!researchDatabase[project.id].funding) {
              researchDatabase[project.id].funding = {
                amount: 150000,
                duration: 18,
                status: "Inactive",
                source: "ASU Research Fund"
              };
            }
            if (!researchDatabase[project.id].relatedFiles) {
              researchDatabase[project.id].relatedFiles = [
                { name: "Research Paper", type: "PDF", size: "2.1 MB" },
                { name: "Supplementary Data", type: "ZIP", size: "5.3 MB" }
              ];
            }
          });
          
          // Initialize page after data is loaded
          initializePage();
        } catch (error) {
          console.error('Error loading data:', error);
          document.getElementById('researchDetail').innerHTML = `
            <div class="info-card text-center py-12">
              <h2 class="text-2xl font-bold text-gray-900 mb-4">Error Loading Data</h2>
              <p class="text-gray-600 mb-6">Unable to load research data. Please refresh the page.</p>
              <a href="research-showcase.html" class="asu text-white px-6 py-3 rounded-lg hover:bg-red-900 transition-colors inline-block">
                Back to Research Showcase
              </a>
            </div>
          `;
        }
      }

      // Old hardcoded data removed - now loading from data.json

      // Get research ID from URL parameter
      function getResearchId() {
        const urlParams = new URLSearchParams(window.location.search);
        return parseInt(urlParams.get("id")) || 1;
      }

      // Get category color
      function getCategoryColor(category) {
        const colors = {
          medical: "bg-red-100 text-red-800",
          technology: "bg-blue-100 text-blue-800",
          environmental: "bg-green-100 text-green-800",
          social: "bg-purple-100 text-purple-800",
          engineering: "bg-orange-100 text-orange-800",
        };

        return colors[category] || "bg-gray-100 text-gray-800";
      }

      // Format number
      function formatNumber(num) {
        if (num >= 1000) {
          return (num / 1000).toFixed(1) + "K";
        }
        return num.toString();
      }

      // Format date
      function formatDate(dateString) {
        const date = new Date(dateString);
        return date.toLocaleDateString("en-US", {
          year: "numeric",
          month: "long",
          day: "numeric",
        });
      }

      // Format currency
      function formatCurrency(amount) {
        return new Intl.NumberFormat("en-US", {
          style: "currency",
          currency: "USD",
          minimumFractionDigits: 0,
        }).format(amount);
      }

      // Render research detail
      function renderResearchDetail(research) {
        const container = document.getElementById("researchDetail");

        container.innerHTML = `
                <!-- Header Section -->
                <div class="info-card mb-6">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4">
                        <div class="flex-1">
                            <div class="flex items-center gap-3 mb-3">
                                <span class="category-badge ${getCategoryColor(
                                  research.category
                                )}">
                                    ${research.category}
                                </span>
                                <span class="text-sm text-gray-500">
                                    <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                    </svg>
                                    ${formatNumber(research.views)} views
                                </span>
                                <span class="text-sm text-gray-500">•</span>
                                <span class="text-sm text-gray-500">${formatDate(
                                  research.date
                                )}</span>
                            </div>
                            <h1 class="text-4xl font-bold text-gray-900 mb-4">${
                              research.title
                            }</h1>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Main Content -->
                    <div class="lg:col-span-2 space-y-6">
                        <!-- Video Section -->
                        <div class="info-card">
                            <h2 class="text-2xl font-bold text-gray-900 mb-4">Research Video</h2>
                            <div class="video-container">
                                <video controls poster="${research.thumbnail}">
                                    <source src="${
                                      research.videoUrl
                                    }" type="video/mp4">
                                    Your browser does not support the video tag.
                                </video>
                            </div>
                            <p class="text-sm text-gray-500 mt-2">Duration: ${
                              research.duration
                            }</p>
                        </div>

                        <!-- Description -->
                        <div class="info-card">
                            <h2 class="text-2xl font-bold text-gray-900 mb-4">Description</h2>
                            <p class="text-gray-700 leading-relaxed">${
                              research.description
                            }</p>
                        </div>

                        <!-- Abstract -->
                        <div class="info-card">
                            <h2 class="text-2xl font-bold text-gray-900 mb-4">Abstract</h2>
                            <p class="text-gray-700 leading-relaxed whitespace-pre-line">${
                              research.abstract
                            }</p>
                        </div>

                        <!-- Methodology -->
                        <div class="info-card">
                            <h2 class="text-2xl font-bold text-gray-900 mb-4">Methodology</h2>
                            <p class="text-gray-700 leading-relaxed whitespace-pre-line">${
                              research.methodology
                            }</p>
                        </div>

                        <!-- Results -->
                        <div class="info-card">
                            <h2 class="text-2xl font-bold text-gray-900 mb-4">Results</h2>
                            <p class="text-gray-700 leading-relaxed whitespace-pre-line">${
                              research.results
                            }</p>
                        </div>

                        <!-- Impact -->
                        <div class="info-card">
                            <h2 class="text-2xl font-bold text-gray-900 mb-4">Impact & Significance</h2>
                            <p class="text-gray-700 leading-relaxed whitespace-pre-line">${
                              research.impact
                            }</p>
                        </div>
                    </div>

                    <!-- Sidebar -->
                    <div class="space-y-6">
                        <!-- Authors -->
                        <div class="info-card">
                            <h3 class="text-xl font-bold text-gray-900 mb-4">Research Team</h3>
                            <div class="space-y-4">
                                ${research.authors
                                  .map(
                                    (author) => `
                                    <div class="author-card p-4 bg-gray-50 rounded-lg">
                                        <div class="flex items-center mb-2">
                                            <div class="w-12 h-12 bg-8c1d40 rounded-full flex items-center justify-center mr-3">
                                                <span class="">
                                                     <div class="w-10 h-10 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full flex items-center justify-center text-white text-xs font-bold mr-4">
                                                          ${author.name
                                                            .split(" ")
                                                            .map((n) => n[0])
                                                            .join("")}
                                                        </div>
                                                </span>
                                            </div>
                                            <div class="flex-1">
                                                <p class="font-semibold text-gray-900">${
                                                  author.name
                                                }</p>
                                                <p class="text-sm text-gray-600">${
                                                  author.role
                                                }</p>
                                            </div>
                                        </div>
                                        <p class="text-sm text-gray-600 mb-1">${
                                          author.affiliation
                                        }</p>
                                        <a href="mailto:${
                                          author.email
                                        }" class="text-sm text-8c1d40 hover:text-red-900">${
                                      author.email
                                    }</a>
                                    </div>
                                `
                                  )
                                  .join("")}
                            </div>
                        </div>

                        <!-- Keywords -->
                        <div class="info-card">
                            <h3 class="text-xl font-bold text-gray-900 mb-4">Keywords</h3>
                            <div class="flex flex-wrap gap-2">
                                ${research.keywords
                                  .map(
                                    (keyword) => `
                                    <span class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm">${keyword}</span>
                                `
                                  )
                                  .join("")}
                            </div>
                        </div>

                        <!-- Funding Information -->
                        <div class="info-card">
                            <h3 class="text-xl font-bold text-gray-900 mb-4">Funding Information</h3>
                            <div class="space-y-3">
                                <div>
                                    <p class="text-sm text-gray-600">Amount</p>
                                    <p class="text-lg font-semibold text-gray-900">${formatCurrency(
                                      research.funding.amount
                                    )}</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-600">Duration</p>
                                    <p class="text-lg font-semibold text-gray-900">${
                                      research.funding.duration
                                    } months</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-600">Status</p>
                                    <span class="inline-block px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-semibold">
                                        ${research.funding.status}
                                    </span>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-600">Funding Source</p>
                                    <p class="text-lg font-semibold text-gray-900">${
                                      research.funding.source
                                    }</p>
                                </div>
                            </div>
                        </div>

                        <!-- Related Files -->
                        <div class="info-card">
                            <h3 class="text-xl font-bold text-gray-900 mb-4">Related Files</h3>
                            <div class="space-y-2">
                                ${research.relatedFiles
                                  .map(
                                    (file) => `
                                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                        <div class="flex items-center">
                                            <svg class="w-5 h-5 text-gray-400 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                                            </svg>
                                            <div>
                                                <p class="text-sm font-medium text-gray-900">${file.name}</p>
                                                <p class="text-xs text-gray-500">${file.type} • ${file.size}</p>
                                            </div>
                                        </div>
                                        <button class="text-8c1d40 hover:text-red-900">
                                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                                            </svg>
                                        </button>
                                    </div>
                                `
                                  )
                                  .join("")}
                            </div>
                        </div>

                        <!-- Share Section -->
                        <div class="info-card">
                            <h3 class="text-xl font-bold text-gray-900 mb-4">Share This Research</h3>
                            <div class="flex gap-3">
                                <button onclick="shareOnTwitter()" class="flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">
                                    Twitter
                                </button>
                                <button onclick="shareOnLinkedIn()" class="flex-1 px-4 py-2 bg-blue-700 text-white rounded-lg hover:bg-blue-800 transition-colors">
                                    LinkedIn
                                </button>
                                <button onclick="copyLink()" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
      }

      // Share functions
      function shareOnTwitter() {
        const url = encodeURIComponent(window.location.href);
        const text = encodeURIComponent(
          document.querySelector("h1").textContent
        );
        window.open(
          `https://twitter.com/intent/tweet?url=${url}&text=${text}`,
          "_blank"
        );
      }

      function shareOnLinkedIn() {
        const url = encodeURIComponent(window.location.href);
        window.open(
          `https://www.linkedin.com/sharing/share-offsite/?url=${url}`,
          "_blank"
        );
      }

      function copyLink() {
        navigator.clipboard.writeText(window.location.href).then(() => {
          alert("Link copied to clipboard!");
        });
      }

      // Basic research data removed - now loading from data.json


      // Initialize page
      function initializePage() {
        const researchId = getResearchId();
        const research = researchDatabase[researchId];

        if (research) {
          document.title = `${research.title} - ASU ResearchFund`;
          renderResearchDetail(research);
        } else {
          document.getElementById("researchDetail").innerHTML = `
            <div class="info-card text-center py-12">
              <h2 class="text-2xl font-bold text-gray-900 mb-4">Research Project Not Found</h2>
              <p class="text-gray-600 mb-6">The research project you're looking for doesn't exist.</p>
              <a href="research-showcase.html" class="asu text-white px-6 py-3 rounded-lg hover:bg-red-900 transition-colors inline-block">
                Back to Research Showcase
              </a>
            </div>
          `;
        }
      }

      // Load data when page loads
      loadData();
    </script>
  </body>
</html>
